services:
  app:
    build: .
    image: thesis-5w1h-eval:latest
    # Inject API keys and other env vars from your local .env file
    env_file:
      - .env
    working_dir: /app
    volumes:
      # Mount datasets and persist results/config outside the container
      - ./data:/app/data
      - ./results:/app/results
      - ./config.yaml:/app/config.yaml:ro
    # Default command; can be overridden on the CLI or via env vars below
    command: ["python", "main.py", "--step", "${STEP:-all}", "--dataset", "${DATASET:-BASSE}", "--limit", "${LIMIT:-0}"]
    # Uncomment to see more logs from Python if needed
    # environment:
    #   - PYTHONUNBUFFERED=1
